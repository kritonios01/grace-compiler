OCAMLC=ocamlc             #ocamlc or ocamlopt
OCAMLDEP=ocamldep
FLAGS=                    #-g for debugging

# prog1 should be compiled to bytecode, and is composed of three
# units: mod1, mod2 and mod3.

# The list of object files for prog1
PROG1_OBJS=mod1.cmo mod2.cmo mod3.cmo

prog1: $(PROG1_OBJS)
	$(OCAMLC) -o prog1 $(OCAMLFLAGS) $(PROG1_OBJS)

# prog2 should be compiled to native-code, and is composed of two
# units: mod4 and mod5.

# The list of object files for prog2
PROG2_OBJS=mod4.cmx mod5.cmx

prog2: $(PROG2_OBJS)
	$(OCAMLOPT) -o prog2 $(OCAMLFLAGS) $(PROG2_OBJS)


%.cmo: %.ml
	$(OCAMLC) $(FLAGS) -c $<

%.cmi: %.mli
	$(OCAMLC) $(FLAGS) -c $<

%.cmx: %.ml
	$(OCAMLC) $(FLAGS) -c $<


depend:
	$(OCAMLDEP) $(INCLUDES) *.mli *.ml > .depend

include .depend


.PHONY: clean distclean

clean:
	$(RM) Lexer.ml Parser.ml Parser.mli Parser.output *.cmo *.cmi *~

distclean: clean
	$(RM) minibasic$(EXE) .depend
